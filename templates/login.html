{% extends "base.html" %} {% block title %}Login - UniGather{% endblock %} {%
block main %}

<section class="form-section">
    <h2>Got an account? Login</h2>
    <form id="login-form">
        <div class="form-field-normal">
            <label>Username:</label>
            <input type="text" name="username" required />
        </div>

        <div class="form-field-normal">
            <label>Password:</label>
            <input type="password" name="password" required />
        </div>

        <div class="form-actions">
            <button type="submit">Submit</button>
        </div>
    </form>
</section>

<section class="form-section">
    <h2>New to UniGather?</h2>
    <p>Sign up with your @city.ac.uk email to join events.</p>
    <br />
    <a href="/register" class="button" style="background-color: #28a745"
        >Register New Account</a
    >
</section>

{% endblock %} {% block scripts %}
<script>
    async function login(event) {
        event.preventDefault();

        const form = event.target;
        const formData = new FormData(form);

        try {
            const response = await fetch("/login", {
                method: "POST",
                body: formData,
            });

            if (response.ok) {
                alert("Successfully logged in.");
                window.location.href = "/events-page";
            } else {
                alert(await response.text());
            }
        } catch (err) {
            console.error("Login Error: ", err);
            alert("Login Error.");
        }
    }

    document.getElementById("login-form").addEventListener("submit", login);
</script>
{% endblock %}
