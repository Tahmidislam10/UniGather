{% extends "base.html" %}
{% block title %}Register - UniGather{% endblock %}

{% block main %}
<section class="login-container">
    <div class="login-card">
        <img src="/static/logo.png" alt="UniGather Logo" class="login-logo" />
        <h2>Create an Account</h2>

        {% if error %}
        <p style="color:red; text-align:center;">{{ error }}</p>
        {% endif %}

        <form action="/register" method="POST" onsubmit="return validateEmail()">
            <div class="form-field-normal">
                <label>Full Name</label>
                <input
                    type="text"
                    name="full_name"
                    placeholder="John Smith"
                    required
                />
            </div>

            <div class="form-field-normal">
                <label>Academic Email</label>
                <input
                    type="email"
                    name="email"
                    placeholder="name@city.ac.uk"
                    required
                />
            </div>

            <div class="form-field-normal">
                <label>Password</label>
                <input type="password" name="password" required />
            </div>

            <p id="error-msg" style="color:red; text-align:center; display:none;"></p>

            <div class="form-actions">
                <button type="submit" class="button">
                    Register
                </button>
            </div>
        </form>

        <div class="register-link-section">
            <p>Already have an account?</p>
            <a
                href="/login"
                style="color: #d61726; font-weight: bold; text-decoration: none"
            >
                Login here
            </a>
        </div>
    </div>
</section>
{% endblock %}

{% block scripts %}
<script>
function validateEmail() {
    const email = document.querySelector('input[name="email"]').value;
    const error = document.getElementById("error-msg");

    if (!email.endsWith("@city.ac.uk")) {
        error.innerText = "Registration is restricted to @city.ac.uk email addresses.";
        error.style.display = "block";
        return false;
    }

    error.style.display = "none";
    return true;
}
</script>
{% endblock %}
